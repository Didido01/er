{"version":3,"sources":["webpack://NeoVis/webpack/universalModuleDefinition","webpack://NeoVis/external {\"commonjs\":\"@babel/runtime-corejs3/core-js-stable/array/from\",\"commonjs2\":\"@babel/runtime-corejs3/core-js-stable/array/from\",\"amd\":\"@babel/runtime-corejs3/core-js-stable/array/from\"}","webpack://NeoVis/external {\"commonjs\":\"@babel/runtime-corejs3/core-js-stable/array/is-array\",\"commonjs2\":\"@babel/runtime-corejs3/core-js-stable/array/is-array\",\"amd\":\"@babel/runtime-corejs3/core-js-stable/array/is-array\"}","webpack://NeoVis/external {\"commonjs\":\"@babel/runtime-corejs3/core-js-stable/instance/concat\",\"commonjs2\":\"@babel/runtime-corejs3/core-js-stable/instance/concat\",\"amd\":\"@babel/runtime-corejs3/core-js-stable/instance/concat\"}","webpack://NeoVis/external {\"commonjs\":\"@babel/runtime-corejs3/core-js-stable/instance/filter\",\"commonjs2\":\"@babel/runtime-corejs3/core-js-stable/instance/filter\",\"amd\":\"@babel/runtime-corejs3/core-js-stable/instance/filter\"}","webpack://NeoVis/external {\"commonjs\":\"@babel/runtime-corejs3/core-js-stable/instance/for-each\",\"commonjs2\":\"@babel/runtime-corejs3/core-js-stable/instance/for-each\",\"amd\":\"@babel/runtime-corejs3/core-js-stable/instance/for-each\"}","webpack://NeoVis/external {\"commonjs\":\"@babel/runtime-corejs3/core-js-stable/instance/map\",\"commonjs2\":\"@babel/runtime-corejs3/core-js-stable/instance/map\",\"amd\":\"@babel/runtime-corejs3/core-js-stable/instance/map\"}","webpack://NeoVis/external {\"commonjs\":\"@babel/runtime-corejs3/core-js-stable/instance/reduce\",\"commonjs2\":\"@babel/runtime-corejs3/core-js-stable/instance/reduce\",\"amd\":\"@babel/runtime-corejs3/core-js-stable/instance/reduce\"}","webpack://NeoVis/external {\"commonjs\":\"@babel/runtime-corejs3/core-js-stable/instance/slice\",\"commonjs2\":\"@babel/runtime-corejs3/core-js-stable/instance/slice\",\"amd\":\"@babel/runtime-corejs3/core-js-stable/instance/slice\"}","webpack://NeoVis/external {\"commonjs\":\"@babel/runtime-corejs3/core-js-stable/object/define-properties\",\"commonjs2\":\"@babel/runtime-corejs3/core-js-stable/object/define-properties\",\"amd\":\"@babel/runtime-corejs3/core-js-stable/object/define-properties\"}","webpack://NeoVis/external {\"commonjs\":\"@babel/runtime-corejs3/core-js-stable/object/define-property\",\"commonjs2\":\"@babel/runtime-corejs3/core-js-stable/object/define-property\",\"amd\":\"@babel/runtime-corejs3/core-js-stable/object/define-property\"}","webpack://NeoVis/external {\"commonjs\":\"@babel/runtime-corejs3/core-js-stable/object/entries\",\"commonjs2\":\"@babel/runtime-corejs3/core-js-stable/object/entries\",\"amd\":\"@babel/runtime-corejs3/core-js-stable/object/entries\"}","webpack://NeoVis/external {\"commonjs\":\"@babel/runtime-corejs3/core-js-stable/object/get-own-property-descriptor\",\"commonjs2\":\"@babel/runtime-corejs3/core-js-stable/object/get-own-property-descriptor\",\"amd\":\"@babel/runtime-corejs3/core-js-stable/object/get-own-property-descriptor\"}","webpack://NeoVis/external {\"commonjs\":\"@babel/runtime-corejs3/core-js-stable/object/get-own-property-descriptors\",\"commonjs2\":\"@babel/runtime-corejs3/core-js-stable/object/get-own-property-descriptors\",\"amd\":\"@babel/runtime-corejs3/core-js-stable/object/get-own-property-descriptors\"}","webpack://NeoVis/external {\"commonjs\":\"@babel/runtime-corejs3/core-js-stable/object/get-own-property-symbols\",\"commonjs2\":\"@babel/runtime-corejs3/core-js-stable/object/get-own-property-symbols\",\"amd\":\"@babel/runtime-corejs3/core-js-stable/object/get-own-property-symbols\"}","webpack://NeoVis/external {\"commonjs\":\"@babel/runtime-corejs3/core-js-stable/object/keys\",\"commonjs2\":\"@babel/runtime-corejs3/core-js-stable/object/keys\",\"amd\":\"@babel/runtime-corejs3/core-js-stable/object/keys\"}","webpack://NeoVis/external {\"commonjs\":\"@babel/runtime-corejs3/core-js-stable/promise\",\"commonjs2\":\"@babel/runtime-corejs3/core-js-stable/promise\",\"amd\":\"@babel/runtime-corejs3/core-js-stable/promise\"}","webpack://NeoVis/external {\"commonjs\":\"@babel/runtime-corejs3/core-js-stable/set-timeout\",\"commonjs2\":\"@babel/runtime-corejs3/core-js-stable/set-timeout\",\"amd\":\"@babel/runtime-corejs3/core-js-stable/set-timeout\"}","webpack://NeoVis/external {\"commonjs\":\"@babel/runtime-corejs3/core-js-stable/symbol\",\"commonjs2\":\"@babel/runtime-corejs3/core-js-stable/symbol\",\"amd\":\"@babel/runtime-corejs3/core-js-stable/symbol\"}","webpack://NeoVis/external {\"commonjs\":\"@babel/runtime-corejs3/core-js-stable/weak-map\",\"commonjs2\":\"@babel/runtime-corejs3/core-js-stable/weak-map\",\"amd\":\"@babel/runtime-corejs3/core-js-stable/weak-map\"}","webpack://NeoVis/external {\"commonjs\":\"@babel/runtime-corejs3/core-js-stable/weak-set\",\"commonjs2\":\"@babel/runtime-corejs3/core-js-stable/weak-set\",\"amd\":\"@babel/runtime-corejs3/core-js-stable/weak-set\"}","webpack://NeoVis/external {\"commonjs\":\"@babel/runtime-corejs3/core-js/get-iterator-method\",\"commonjs2\":\"@babel/runtime-corejs3/core-js/get-iterator-method\",\"amd\":\"@babel/runtime-corejs3/core-js/get-iterator-method\"}","webpack://NeoVis/external {\"commonjs\":\"@babel/runtime-corejs3/helpers/asyncToGenerator\",\"commonjs2\":\"@babel/runtime-corejs3/helpers/asyncToGenerator\",\"amd\":\"@babel/runtime-corejs3/helpers/asyncToGenerator\"}","webpack://NeoVis/external {\"commonjs\":\"@babel/runtime-corejs3/helpers/classCallCheck\",\"commonjs2\":\"@babel/runtime-corejs3/helpers/classCallCheck\",\"amd\":\"@babel/runtime-corejs3/helpers/classCallCheck\"}","webpack://NeoVis/external {\"commonjs\":\"@babel/runtime-corejs3/helpers/classPrivateFieldGet\",\"commonjs2\":\"@babel/runtime-corejs3/helpers/classPrivateFieldGet\",\"amd\":\"@babel/runtime-corejs3/helpers/classPrivateFieldGet\"}","webpack://NeoVis/external {\"commonjs\":\"@babel/runtime-corejs3/helpers/classPrivateFieldSet\",\"commonjs2\":\"@babel/runtime-corejs3/helpers/classPrivateFieldSet\",\"amd\":\"@babel/runtime-corejs3/helpers/classPrivateFieldSet\"}","webpack://NeoVis/external {\"commonjs\":\"@babel/runtime-corejs3/helpers/createClass\",\"commonjs2\":\"@babel/runtime-corejs3/helpers/createClass\",\"amd\":\"@babel/runtime-corejs3/helpers/createClass\"}","webpack://NeoVis/external {\"commonjs\":\"@babel/runtime-corejs3/helpers/defineProperty\",\"commonjs2\":\"@babel/runtime-corejs3/helpers/defineProperty\",\"amd\":\"@babel/runtime-corejs3/helpers/defineProperty\"}","webpack://NeoVis/external {\"commonjs\":\"@babel/runtime-corejs3/helpers/slicedToArray\",\"commonjs2\":\"@babel/runtime-corejs3/helpers/slicedToArray\",\"amd\":\"@babel/runtime-corejs3/helpers/slicedToArray\"}","webpack://NeoVis/external {\"commonjs\":\"@babel/runtime-corejs3/helpers/typeof\",\"commonjs2\":\"@babel/runtime-corejs3/helpers/typeof\",\"amd\":\"@babel/runtime-corejs3/helpers/typeof\"}","webpack://NeoVis/external {\"commonjs\":\"@babel/runtime-corejs3/regenerator\",\"commonjs2\":\"@babel/runtime-corejs3/regenerator\",\"amd\":\"@babel/runtime-corejs3/regenerator\"}","webpack://NeoVis/external {\"commonjs\":\"core-js/modules/es.array.iterator.js\",\"commonjs2\":\"core-js/modules/es.array.iterator.js\",\"amd\":\"core-js/modules/es.array.iterator.js\"}","webpack://NeoVis/external {\"commonjs\":\"core-js/modules/es.function.name.js\",\"commonjs2\":\"core-js/modules/es.function.name.js\",\"amd\":\"core-js/modules/es.function.name.js\"}","webpack://NeoVis/external {\"commonjs\":\"core-js/modules/es.object.to-string.js\",\"commonjs2\":\"core-js/modules/es.object.to-string.js\",\"amd\":\"core-js/modules/es.object.to-string.js\"}","webpack://NeoVis/external {\"commonjs\":\"core-js/modules/es.promise.js\",\"commonjs2\":\"core-js/modules/es.promise.js\",\"amd\":\"core-js/modules/es.promise.js\"}","webpack://NeoVis/external {\"commonjs\":\"core-js/modules/es.string.iterator.js\",\"commonjs2\":\"core-js/modules/es.string.iterator.js\",\"amd\":\"core-js/modules/es.string.iterator.js\"}","webpack://NeoVis/external {\"commonjs\":\"core-js/modules/web.dom-collections.iterator.js\",\"commonjs2\":\"core-js/modules/web.dom-collections.iterator.js\",\"amd\":\"core-js/modules/web.dom-collections.iterator.js\"}","webpack://NeoVis/external {\"commonjs\":\"deepmerge\",\"commonjs2\":\"deepmerge\",\"amd\":\"deepmerge\"}","webpack://NeoVis/external {\"commonjs\":\"neo4j-driver\",\"commonjs2\":\"neo4j-driver\",\"amd\":\"neo4j-driver\"}","webpack://NeoVis/external {\"commonjs\":\"vis-network/standalone\",\"commonjs2\":\"vis-network/standalone\",\"amd\":\"vis-network/standalone\"}","webpack://NeoVis/webpack/bootstrap","webpack://NeoVis/webpack/runtime/compat get default export","webpack://NeoVis/webpack/runtime/define property getters","webpack://NeoVis/webpack/runtime/hasOwnProperty shorthand","webpack://NeoVis/webpack/runtime/make namespace object","webpack://NeoVis/./src/events.ts","webpack://NeoVis/./src/defaults.ts","webpack://NeoVis/./src/neovis.ts"],"names":["root","factory","exports","module","require","define","amd","undefined","self","__WEBPACK_EXTERNAL_MODULE__708__","__WEBPACK_EXTERNAL_MODULE__344__","__WEBPACK_EXTERNAL_MODULE__382__","__WEBPACK_EXTERNAL_MODULE__105__","__WEBPACK_EXTERNAL_MODULE__86__","__WEBPACK_EXTERNAL_MODULE__219__","__WEBPACK_EXTERNAL_MODULE__921__","__WEBPACK_EXTERNAL_MODULE__915__","__WEBPACK_EXTERNAL_MODULE__465__","__WEBPACK_EXTERNAL_MODULE__311__","__WEBPACK_EXTERNAL_MODULE__418__","__WEBPACK_EXTERNAL_MODULE__764__","__WEBPACK_EXTERNAL_MODULE__698__","__WEBPACK_EXTERNAL_MODULE__938__","__WEBPACK_EXTERNAL_MODULE__845__","__WEBPACK_EXTERNAL_MODULE__369__","__WEBPACK_EXTERNAL_MODULE__893__","__WEBPACK_EXTERNAL_MODULE__301__","__WEBPACK_EXTERNAL_MODULE__441__","__WEBPACK_EXTERNAL_MODULE__853__","__WEBPACK_EXTERNAL_MODULE__701__","__WEBPACK_EXTERNAL_MODULE__259__","__WEBPACK_EXTERNAL_MODULE__182__","__WEBPACK_EXTERNAL_MODULE__398__","__WEBPACK_EXTERNAL_MODULE__673__","__WEBPACK_EXTERNAL_MODULE__6__","__WEBPACK_EXTERNAL_MODULE__322__","__WEBPACK_EXTERNAL_MODULE__207__","__WEBPACK_EXTERNAL_MODULE__434__","__WEBPACK_EXTERNAL_MODULE__936__","__WEBPACK_EXTERNAL_MODULE__952__","__WEBPACK_EXTERNAL_MODULE__192__","__WEBPACK_EXTERNAL_MODULE__909__","__WEBPACK_EXTERNAL_MODULE__607__","__WEBPACK_EXTERNAL_MODULE__602__","__WEBPACK_EXTERNAL_MODULE__722__","__WEBPACK_EXTERNAL_MODULE__235__","__WEBPACK_EXTERNAL_MODULE__903__","__WEBPACK_EXTERNAL_MODULE__53__","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","n","getter","__esModule","d","a","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","r","Symbol","toStringTag","value","NeoVisEvents","defaults","neo4j","initialQuery","neo4jUri","neo4jUser","neo4jPassword","driverConfig","encrypted","trust","maxConnectionPoolSize","connectionAcquisitionTimeout","disableLosslessIntegers","visJs","nodes","font","size","strokeWidth","scaling","edges","arrows","to","enabled","length","layout","improvedLayout","hierarchical","sortMethod","physics","adaptiveTimestep","stabilization","iterations","fit","EventController","this","_handlers","CompletionEvent","ErrorEvent","ClickNodeEvent","ClickEdgeEvent","eventType","handler","Error","push","values","NEOVIS_DEFAULT_CONFIG","NEOVIS_ADVANCED_CONFIG","NeoVis","config","vis","_init","_consoleLog","_data","message","level","_config","console_debug","console","defaultLabelConfig","defaultRelationshipConfig","nonFlat","labels","deepmerge","defaultRelationshipsConfig","relationships","_driver","Neo4j","server_url","server_user","server_password","_database","server_database","_query","initial_cypher","_container","document","getElementById","container_id","cypher","id","session","database","results","readTransaction","tx","run","result","records","record","v","close","pop","func","node","staticConfig","object","_buildStaticObject","propertyNameConfig","neo4jObj","_retrieveProperty","cypherConfig","_buildCypherObject","_runCypher","functionConfig","_buildFunctionObject","_runFunction","neo4jNode","label","labelConfig","identity","toInt","raw","relationshipConfig","type","edge","from","start","end","query","recordCount","dataBuildPromises","limit","subscribe","onNext","constructor","name","dataPromises","buildNodeVisObject","update","e","buildEdgeVisObject","startNode","endNode","segments","relationship","Array","onCompleted","options","visConfig","container","stopSimulation","generateEvent","record_count","neoVis","on","params","nodeId","getNodeAt","pointer","DOM","edgeId","getEdgeAt","onError","error","error_msg","clear","register","render","clearNetwork","baseObject","neo4jObject","static","propertyConfig","property","function","advancedConfig","_buildPropertyNameObject","_propertyToHtml","out","val","properties","objectToTitleHtml","titleProperties","titleString","propVal","title","createElement","innerHTML","objectToTitleString","migrateFromOldConfig","oldNeoVisConfig","hierarchical_sort_method","newLabelsConfig","oldLabelConfig","caption","group","community","sizeCypher","props","title_properties","shape","image","oldRelationshipsConfig","thickness"],"mappings":"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","file":"neovis-without-dependencies.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"@babel/runtime-corejs3/core-js-stable/object/get-own-property-symbols\"), require(\"@babel/runtime-corejs3/core-js-stable/instance/filter\"), require(\"@babel/runtime-corejs3/core-js-stable/object/get-own-property-descriptor\"), require(\"@babel/runtime-corejs3/core-js-stable/object/get-own-property-descriptors\"), require(\"@babel/runtime-corejs3/core-js-stable/object/define-properties\"), require(\"@babel/runtime-corejs3/core-js-stable/object/define-property\"), require(\"@babel/runtime-corejs3/core-js-stable/instance/slice\"), require(\"@babel/runtime-corejs3/core-js-stable/array/from\"), require(\"@babel/runtime-corejs3/core-js/get-iterator-method\"), require(\"@babel/runtime-corejs3/helpers/slicedToArray\"), require(\"@babel/runtime-corejs3/helpers/typeof\"), require(\"@babel/runtime-corejs3/helpers/asyncToGenerator\"), require(\"@babel/runtime-corejs3/helpers/classCallCheck\"), require(\"@babel/runtime-corejs3/helpers/createClass\"), require(\"@babel/runtime-corejs3/helpers/defineProperty\"), require(\"@babel/runtime-corejs3/helpers/classPrivateFieldSet\"), require(\"@babel/runtime-corejs3/helpers/classPrivateFieldGet\"), require(\"core-js/modules/es.function.name.js\"), require(\"core-js/modules/es.array.iterator.js\"), require(\"core-js/modules/es.object.to-string.js\"), require(\"core-js/modules/es.promise.js\"), require(\"core-js/modules/es.string.iterator.js\"), require(\"core-js/modules/web.dom-collections.iterator.js\"), require(\"@babel/runtime-corejs3/regenerator\"), require(\"@babel/runtime-corejs3/core-js-stable/symbol\"), require(\"@babel/runtime-corejs3/core-js-stable/array/is-array\"), require(\"@babel/runtime-corejs3/core-js-stable/object/keys\"), require(\"@babel/runtime-corejs3/core-js-stable/instance/for-each\"), require(\"@babel/runtime-corejs3/core-js-stable/instance/map\"), require(\"@babel/runtime-corejs3/core-js-stable/promise\"), require(\"@babel/runtime-corejs3/core-js-stable/set-timeout\"), require(\"@babel/runtime-corejs3/core-js-stable/instance/concat\"), require(\"@babel/runtime-corejs3/core-js-stable/instance/reduce\"), require(\"@babel/runtime-corejs3/core-js-stable/object/entries\"), require(\"@babel/runtime-corejs3/core-js-stable/weak-map\"), require(\"@babel/runtime-corejs3/core-js-stable/weak-set\"), require(\"neo4j-driver\"), require(\"vis-network/standalone\"), require(\"deepmerge\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"@babel/runtime-corejs3/core-js-stable/object/get-own-property-symbols\", \"@babel/runtime-corejs3/core-js-stable/instance/filter\", \"@babel/runtime-corejs3/core-js-stable/object/get-own-property-descriptor\", \"@babel/runtime-corejs3/core-js-stable/object/get-own-property-descriptors\", \"@babel/runtime-corejs3/core-js-stable/object/define-properties\", \"@babel/runtime-corejs3/core-js-stable/object/define-property\", \"@babel/runtime-corejs3/core-js-stable/instance/slice\", \"@babel/runtime-corejs3/core-js-stable/array/from\", \"@babel/runtime-corejs3/core-js/get-iterator-method\", \"@babel/runtime-corejs3/helpers/slicedToArray\", \"@babel/runtime-corejs3/helpers/typeof\", \"@babel/runtime-corejs3/helpers/asyncToGenerator\", \"@babel/runtime-corejs3/helpers/classCallCheck\", \"@babel/runtime-corejs3/helpers/createClass\", \"@babel/runtime-corejs3/helpers/defineProperty\", \"@babel/runtime-corejs3/helpers/classPrivateFieldSet\", \"@babel/runtime-corejs3/helpers/classPrivateFieldGet\", \"core-js/modules/es.function.name.js\", \"core-js/modules/es.array.iterator.js\", \"core-js/modules/es.object.to-string.js\", \"core-js/modules/es.promise.js\", \"core-js/modules/es.string.iterator.js\", \"core-js/modules/web.dom-collections.iterator.js\", \"@babel/runtime-corejs3/regenerator\", \"@babel/runtime-corejs3/core-js-stable/symbol\", \"@babel/runtime-corejs3/core-js-stable/array/is-array\", \"@babel/runtime-corejs3/core-js-stable/object/keys\", \"@babel/runtime-corejs3/core-js-stable/instance/for-each\", \"@babel/runtime-corejs3/core-js-stable/instance/map\", \"@babel/runtime-corejs3/core-js-stable/promise\", \"@babel/runtime-corejs3/core-js-stable/set-timeout\", \"@babel/runtime-corejs3/core-js-stable/instance/concat\", \"@babel/runtime-corejs3/core-js-stable/instance/reduce\", \"@babel/runtime-corejs3/core-js-stable/object/entries\", \"@babel/runtime-corejs3/core-js-stable/weak-map\", \"@babel/runtime-corejs3/core-js-stable/weak-set\", \"neo4j-driver\", \"vis-network/standalone\", \"deepmerge\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"NeoVis\"] = factory(require(\"@babel/runtime-corejs3/core-js-stable/object/get-own-property-symbols\"), require(\"@babel/runtime-corejs3/core-js-stable/instance/filter\"), require(\"@babel/runtime-corejs3/core-js-stable/object/get-own-property-descriptor\"), require(\"@babel/runtime-corejs3/core-js-stable/object/get-own-property-descriptors\"), require(\"@babel/runtime-corejs3/core-js-stable/object/define-properties\"), require(\"@babel/runtime-corejs3/core-js-stable/object/define-property\"), require(\"@babel/runtime-corejs3/core-js-stable/instance/slice\"), require(\"@babel/runtime-corejs3/core-js-stable/array/from\"), require(\"@babel/runtime-corejs3/core-js/get-iterator-method\"), require(\"@babel/runtime-corejs3/helpers/slicedToArray\"), require(\"@babel/runtime-corejs3/helpers/typeof\"), require(\"@babel/runtime-corejs3/helpers/asyncToGenerator\"), require(\"@babel/runtime-corejs3/helpers/classCallCheck\"), require(\"@babel/runtime-corejs3/helpers/createClass\"), require(\"@babel/runtime-corejs3/helpers/defineProperty\"), require(\"@babel/runtime-corejs3/helpers/classPrivateFieldSet\"), require(\"@babel/runtime-corejs3/helpers/classPrivateFieldGet\"), require(\"core-js/modules/es.function.name.js\"), require(\"core-js/modules/es.array.iterator.js\"), require(\"core-js/modules/es.object.to-string.js\"), require(\"core-js/modules/es.promise.js\"), require(\"core-js/modules/es.string.iterator.js\"), require(\"core-js/modules/web.dom-collections.iterator.js\"), require(\"@babel/runtime-corejs3/regenerator\"), require(\"@babel/runtime-corejs3/core-js-stable/symbol\"), require(\"@babel/runtime-corejs3/core-js-stable/array/is-array\"), require(\"@babel/runtime-corejs3/core-js-stable/object/keys\"), require(\"@babel/runtime-corejs3/core-js-stable/instance/for-each\"), require(\"@babel/runtime-corejs3/core-js-stable/instance/map\"), require(\"@babel/runtime-corejs3/core-js-stable/promise\"), require(\"@babel/runtime-corejs3/core-js-stable/set-timeout\"), require(\"@babel/runtime-corejs3/core-js-stable/instance/concat\"), require(\"@babel/runtime-corejs3/core-js-stable/instance/reduce\"), require(\"@babel/runtime-corejs3/core-js-stable/object/entries\"), require(\"@babel/runtime-corejs3/core-js-stable/weak-map\"), require(\"@babel/runtime-corejs3/core-js-stable/weak-set\"), require(\"neo4j-driver\"), require(\"vis-network/standalone\"), require(\"deepmerge\"));\n\telse\n\t\troot[\"NeoVis\"] = factory(root[undefined], root[undefined], root[undefined], root[undefined], root[undefined], root[undefined], root[undefined], root[undefined], root[undefined], root[undefined], root[undefined], root[undefined], root[undefined], root[undefined], root[undefined], root[undefined], root[undefined], root[undefined], root[undefined], root[undefined], root[undefined], root[undefined], root[undefined], root[undefined], root[undefined], root[undefined], root[undefined], root[undefined], root[undefined], root[undefined], root[undefined], root[undefined], root[undefined], root[undefined], root[undefined], root[undefined], root[undefined], root[undefined], root[undefined]);\n})(self, function(__WEBPACK_EXTERNAL_MODULE__708__, __WEBPACK_EXTERNAL_MODULE__344__, __WEBPACK_EXTERNAL_MODULE__382__, __WEBPACK_EXTERNAL_MODULE__105__, __WEBPACK_EXTERNAL_MODULE__86__, __WEBPACK_EXTERNAL_MODULE__219__, __WEBPACK_EXTERNAL_MODULE__921__, __WEBPACK_EXTERNAL_MODULE__915__, __WEBPACK_EXTERNAL_MODULE__465__, __WEBPACK_EXTERNAL_MODULE__311__, __WEBPACK_EXTERNAL_MODULE__418__, __WEBPACK_EXTERNAL_MODULE__764__, __WEBPACK_EXTERNAL_MODULE__698__, __WEBPACK_EXTERNAL_MODULE__938__, __WEBPACK_EXTERNAL_MODULE__845__, __WEBPACK_EXTERNAL_MODULE__369__, __WEBPACK_EXTERNAL_MODULE__893__, __WEBPACK_EXTERNAL_MODULE__301__, __WEBPACK_EXTERNAL_MODULE__441__, __WEBPACK_EXTERNAL_MODULE__853__, __WEBPACK_EXTERNAL_MODULE__701__, __WEBPACK_EXTERNAL_MODULE__259__, __WEBPACK_EXTERNAL_MODULE__182__, __WEBPACK_EXTERNAL_MODULE__398__, __WEBPACK_EXTERNAL_MODULE__673__, __WEBPACK_EXTERNAL_MODULE__6__, __WEBPACK_EXTERNAL_MODULE__322__, __WEBPACK_EXTERNAL_MODULE__207__, __WEBPACK_EXTERNAL_MODULE__434__, __WEBPACK_EXTERNAL_MODULE__936__, __WEBPACK_EXTERNAL_MODULE__952__, __WEBPACK_EXTERNAL_MODULE__192__, __WEBPACK_EXTERNAL_MODULE__909__, __WEBPACK_EXTERNAL_MODULE__607__, __WEBPACK_EXTERNAL_MODULE__602__, __WEBPACK_EXTERNAL_MODULE__722__, __WEBPACK_EXTERNAL_MODULE__235__, __WEBPACK_EXTERNAL_MODULE__903__, __WEBPACK_EXTERNAL_MODULE__53__) {\nreturn ","module.exports = __WEBPACK_EXTERNAL_MODULE__915__;","module.exports = __WEBPACK_EXTERNAL_MODULE__6__;","module.exports = __WEBPACK_EXTERNAL_MODULE__192__;","module.exports = __WEBPACK_EXTERNAL_MODULE__344__;","module.exports = __WEBPACK_EXTERNAL_MODULE__207__;","module.exports = __WEBPACK_EXTERNAL_MODULE__434__;","module.exports = __WEBPACK_EXTERNAL_MODULE__909__;","module.exports = __WEBPACK_EXTERNAL_MODULE__921__;","module.exports = __WEBPACK_EXTERNAL_MODULE__86__;","module.exports = __WEBPACK_EXTERNAL_MODULE__219__;","module.exports = __WEBPACK_EXTERNAL_MODULE__607__;","module.exports = __WEBPACK_EXTERNAL_MODULE__382__;","module.exports = __WEBPACK_EXTERNAL_MODULE__105__;","module.exports = __WEBPACK_EXTERNAL_MODULE__708__;","module.exports = __WEBPACK_EXTERNAL_MODULE__322__;","module.exports = __WEBPACK_EXTERNAL_MODULE__936__;","module.exports = __WEBPACK_EXTERNAL_MODULE__952__;","module.exports = __WEBPACK_EXTERNAL_MODULE__673__;","module.exports = __WEBPACK_EXTERNAL_MODULE__602__;","module.exports = __WEBPACK_EXTERNAL_MODULE__722__;","module.exports = __WEBPACK_EXTERNAL_MODULE__465__;","module.exports = __WEBPACK_EXTERNAL_MODULE__764__;","module.exports = __WEBPACK_EXTERNAL_MODULE__698__;","module.exports = __WEBPACK_EXTERNAL_MODULE__893__;","module.exports = __WEBPACK_EXTERNAL_MODULE__369__;","module.exports = __WEBPACK_EXTERNAL_MODULE__938__;","module.exports = __WEBPACK_EXTERNAL_MODULE__845__;","module.exports = __WEBPACK_EXTERNAL_MODULE__311__;","module.exports = __WEBPACK_EXTERNAL_MODULE__418__;","module.exports = __WEBPACK_EXTERNAL_MODULE__398__;","module.exports = __WEBPACK_EXTERNAL_MODULE__441__;","module.exports = __WEBPACK_EXTERNAL_MODULE__301__;","module.exports = __WEBPACK_EXTERNAL_MODULE__853__;","module.exports = __WEBPACK_EXTERNAL_MODULE__701__;","module.exports = __WEBPACK_EXTERNAL_MODULE__259__;","module.exports = __WEBPACK_EXTERNAL_MODULE__182__;","module.exports = __WEBPACK_EXTERNAL_MODULE__53__;","module.exports = __WEBPACK_EXTERNAL_MODULE__235__;","module.exports = __WEBPACK_EXTERNAL_MODULE__903__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","export enum NeoVisEvents {\r\n\tCompletionEvent = 'completed',\r\n\tClickNodeEvent = 'clickNode',\r\n\tClickEdgeEvent ='clickEdge',\r\n\tErrorEvent = 'error'\r\n};\r\n\r\nexport class EventController {\r\n\tprivate readonly _handlers: { [p: string]: Function[] };\r\n\r\n\tconstructor() {\r\n\t\tthis._handlers = {\r\n\t\t\t[NeoVisEvents.CompletionEvent]: [],\r\n\t\t\t[NeoVisEvents.ErrorEvent]: [],\r\n\t\t\t[NeoVisEvents.ClickNodeEvent]: [],\r\n\t\t\t[NeoVisEvents.ClickEdgeEvent]: [],\r\n\t\t};\r\n\t}\r\n\r\n\t/**\r\n\t *\r\n\t * @param {string} eventType - Type of the event to be handled\r\n\t * @param {callback} handler - Handler to manage the event\r\n\t */\r\n\tregister(eventType: NeoVisEvents, handler: Function): void {\r\n\t\tif (this._handlers[eventType] === undefined) {\r\n\t\t\tthrow new Error('Unknown event: ' + eventType);\r\n\t\t}\r\n\r\n\t\tthis._handlers[eventType].push(handler);\r\n\t}\r\n\r\n\t/**\r\n\t *\r\n\t * @param {string} eventType - Type of the event generated\r\n\t * @param {object} values - Values associated to the event\r\n\t */\r\n\tgenerateEvent(eventType: NeoVisEvents, values: any): void {\r\n\t\tif (this._handlers[eventType] === undefined) {\r\n\t\t\tthrow new Error('Unknown event: ' + eventType);\r\n\t\t}\r\n\r\n\t\tfor (const handler of this._handlers[eventType]) {\r\n\t\t\thandler(values);\r\n\t\t}\r\n\t}\r\n}\r\n","const defaults = {\r\n\r\n\tneo4j: {\r\n\t\tinitialQuery: `MATCH (n) WHERE exists(n.pagerank)\r\n                        WITH (n), RAND() AS random\r\n                        ORDER BY random LIMIT 3000\r\n                        OPTIONAL MATCH (n)-[r]-(m)\r\n                        //WITH n,r,m WHERE exists(n.pagerank) AND exists(m.pagerank) AND exists(m.community)\r\n                        RETURN n, r, m;`,\r\n\t\tneo4jUri: 'bolt://localhost:7687',\r\n\t\tneo4jUser: 'neo4j',\r\n\t\tneo4jPassword: 'neo4j',\r\n\t\tdriverConfig: {\r\n\t\t\tencrypted: 'ENCRYPTION_OFF',\r\n\t\t\ttrust: 'TRUST_ALL_CERTIFICATES',\r\n\t\t\tmaxConnectionPoolSize: 100,\r\n\t\t\tconnectionAcquisitionTimeout: 10000,\r\n\t\t\tdisableLosslessIntegers: true,\r\n\t\t}\r\n\t},\r\n\r\n\tvisJs: {\r\n\t\tnodes: {\r\n\t\t\tfont: {\r\n\t\t\t\tsize: 26,\r\n\t\t\t\tstrokeWidth: 7\r\n\t\t\t},\r\n\t\t\tscaling: {}\r\n\t\t},\r\n\t\tedges: {\r\n\t\t\tarrows: {\r\n\t\t\t\tto: { enabled: false }\r\n\t\t\t},\r\n\t\t\tlength: 200\r\n\t\t},\r\n\t\tlayout: {\r\n\t\t\timprovedLayout: false,\r\n\t\t\thierarchical: {\r\n\t\t\t\tenabled: false,\r\n\t\t\t\tsortMethod: 'hubsize'\r\n\t\t\t}\r\n\t\t},\r\n\t\tphysics: { // TODO: adaptive physics settings based on size of graph rendered\r\n\t\t\t// enabled: true,\r\n\t\t\t// timestep: 0.5,\r\n\t\t\t// stabilization: {\r\n\t\t\t//     iterations: 10\r\n\t\t\t// }\r\n\r\n\t\t\tadaptiveTimestep: true,\r\n\t\t\t// barnesHut: {\r\n\t\t\t//     gravitationalConstant: -8000,\r\n\t\t\t//     springConstant: 0.04,\r\n\t\t\t//     springLength: 95\r\n\t\t\t// },\r\n\t\t\tstabilization: {\r\n\t\t\t\titerations: 200,\r\n\t\t\t\tfit: true\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n};\r\n\r\nexport { defaults };","'use strict';\r\n\r\nimport Neo4j from 'neo4j-driver';\r\nimport type * as Neo4jTypes from 'neo4j-driver';\r\nimport * as vis from 'vis-network/standalone';\r\nimport {defaults} from './defaults';\r\nimport {EventController, NeoVisEvents} from './events';\r\nimport deepmerge from 'deepmerge';\r\nimport type * as VisNetwork from \"vis-network\";\r\n\r\nexport const NEOVIS_DEFAULT_CONFIG = Symbol();\r\nexport const NEOVIS_ADVANCED_CONFIG = Symbol();\r\n\r\nexport { NeoVisEvents } from './events';\r\ntype NumberOrInteger = number | Neo4jTypes.Integer\r\n\r\n/**\r\n * Maps a type recursively and replace each non object type with the new type\r\n * @param <T> type to map\r\n * @param <New> type to map to for each non object type\r\n */\r\nexport type RecursiveMapTo<T, New> = {\r\n\t[P in keyof T]: T[P] extends object ? RecursiveMapTo<T[P], New> : New\r\n};\r\n\r\n/**\r\n * Maps a type recursively and adds the ability for each object property to be a function that returns the same type\r\n * but replace each non object type with a function that returns the same type\r\n * @param <T> type to map\r\n * @param <PARAM_TYPE> type of parameter the functions get\r\n */\r\nexport type RecursiveMapToFunction<T, PARAM_TYPE> = {\r\n\t[P in keyof T]: T[P] extends object ? ((param: PARAM_TYPE) => T[P]) | (RecursiveMapToFunction<T[P], PARAM_TYPE>) : (param: PARAM_TYPE) => T[P]\r\n};\r\n\r\n/**\r\n * Cypher quarry\r\n */\r\nexport type Cypher = string;\r\n\r\nexport interface NeoVisAdvanceConfig<VIS_TYPE, NEO_TYPE> {\r\n\t/**\r\n\t * Static values that will the same for every node/relationship\r\n\t * */\r\n\tstatic?: VIS_TYPE;\r\n\t/**\r\n\t * Cypher that will be called for every object (will look the same as\r\n\t */\r\n\tcypher?: RecursiveMapTo<VIS_TYPE, Cypher>;\r\n\tfunction?: RecursiveMapToFunction<VIS_TYPE, NEO_TYPE>;\r\n}\r\n\r\nexport interface NonFlatNeoVisAdvanceConfig<VIS_TYPE, NEO_TYPE> extends NeoVisAdvanceConfig<VIS_TYPE, NEO_TYPE> {\r\n\tproperty?: RecursiveMapTo<VIS_TYPE, string>;\r\n}\r\n\r\ntype NeovisDataConfig<VIS_TYPE, NEO_TYPE> = RecursiveMapTo<VIS_TYPE, string> & { [NEOVIS_ADVANCED_CONFIG]?: NeoVisAdvanceConfig<VIS_TYPE, NEO_TYPE> };\r\n\r\n/**\r\n * A mapper between neo4j node properties names to vis-network node config\r\n * @link https://visjs.github.io/vis-network/docs/network/nodes.html\r\n */\r\nexport interface LabelConfig extends RecursiveMapTo<VisNetwork.Node, string> {\r\n\t/**\r\n\t * advance options which allow for:\r\n\t * mapping static options to each node\r\n\t * mapping cypher to run for each node to determine vis-network node option\r\n\t * mapping function that gets the neo4j node and returns vis-network node option\r\n\t */\r\n\t[NEOVIS_ADVANCED_CONFIG]?: NeoVisAdvanceConfig<VisNetwork.Node, Neo4jTypes.Node<number>>;\r\n}\r\n\r\n/**\r\n * A mapper between neo4j relationship properties names to vis-network edge config\r\n * @link https://visjs.github.io/vis-network/docs/network/edges.html\r\n */\r\nexport interface RelationshipConfig extends RecursiveMapTo<VisNetwork.Edge, string> {\r\n\t/**\r\n\t * advance options which allow for:\r\n\t * mapping static options to each edge\r\n\t * mapping cypher to run for each relationship to determine vis-network edge option\r\n\t * mapping function that gets the neo4j relationship and returns vis-network edge option\r\n\t */\r\n\t[NEOVIS_ADVANCED_CONFIG]?: NeoVisAdvanceConfig<VisNetwork.Edge, Neo4jTypes.Relationship<number>>;\r\n}\r\n\r\nexport interface Neo4jConfig {\r\n\t/**\r\n\t * neo4j server\r\n\t * @example bolt://localhost:7687\r\n\t */\r\n\tserver_url?: string;\r\n\tserver_user?: string;\r\n\tserver_password?: string;\r\n\t/**\r\n\t * @link https://neo4j.com/docs/api/javascript-driver/current/function/index.html#configuration\r\n\t */\r\n\tdriverConfig?: Neo4jTypes.Config;\r\n}\r\n\r\nexport interface BaseNeovisConfig {\r\n\t/**\r\n\t * Html id of the element you want Neovis to render on\r\n\t */\r\n\tcontainer_id: string;\r\n\t/**\r\n\t * database name you want to connect to\r\n\t * @default neo4j\r\n\t */\r\n\tserver_database?: string;\r\n\t/**\r\n\t * Neo4j Driver instance or configuration to make one\r\n\t */\r\n\tneo4j?: Neo4jTypes.Driver | Neo4jConfig;\r\n\t/**\r\n\t * Vis network config to override neovis defaults\r\n\t * @link https://visjs.github.io/vis-network/docs/network/#options\r\n\t */\r\n\tvisConfig?: VisNetwork.Options;\r\n\r\n\t/**\r\n\t * The Cypher query that will get the data\r\n\t */\r\n\tinitial_cypher?: Cypher;\r\n\t/**\r\n\t * Should output debug messages to console\r\n\t * @default false\r\n\t */\r\n\tconsole_debug?: boolean;\r\n\r\n\r\n\t/**\r\n\t * Tells Neovis is the config is flat or not\r\n\t * @default false\r\n\t */\r\n\tnonFlat?: boolean;\r\n}\r\n\r\n/**\r\n * @example\r\n * ```js\r\n * //simple\r\n * {\r\n *      container_id: \"viz\",\r\n *      neo4j: {\r\n *      \tserver_url: \"bolt://localhost:7687\",\r\n *      \tserver_user: \"neo4j\",\r\n *      \tserver_password: \"sorts-swims-burglaries\"\r\n *      },\r\n *      labels: {\r\n *      \tCharacter: {\r\n *      \t\tlabel: \"name\",\r\n *      \t\tvalue: \"pagerank\",\r\n *      \t\tgroup: \"community\"\r\n *      \t}\r\n *      },\r\n *      relationships: {\r\n *      \tINTERACTS: {\r\n *      \t\tvalue: \"weight\"\r\n *      \t}\r\n *      },\r\n *      initial_cypher: \"MATCH (n)-[r:INTERACTS]->(m) RETURN n,r,m\"\r\n * }\r\n * // advance\r\n * {\r\n *      container_id: 'viz',\r\n *      neo4j: {\r\n *      \tserver_url: 'bolt://localhost:7687',\r\n *      \tserver_user: 'neo4j',\r\n *      \tserver_password: 'gland-presentation-worry'\r\n *      },\r\n *      visConfig: {\r\n *      \tnodes: {\r\n *      \t\tshape: 'square'\r\n *      \t},\r\n *      \tedges: {\r\n *      \t\tarrows: {\r\n *      \t\t\tto: {enabled: true}\r\n *      \t\t}\r\n *      \t},\r\n *      },\r\n *      labels: {\r\n *      \tCharacter: {\r\n *      \t\tlabel: 'pagerank',\r\n *      \t\tgroup: 'community',\r\n *      \t\t[Neovis.NEOVIS_ADVANCED_CONFIG]: {\r\n *      \t\t\tcypher: {\r\n *      \t\t\t\tvalue: \"MATCH (n) WHERE id(n) = $id RETURN n.size\"\r\n *      \t\t\t},\r\n *      \t\t\tfunction: {\r\n *      \t\t\t\ttitle: (node) => {\r\n *      \t\t\t\t\treturn viz.nodeToHtml(node, undefined);\r\n *      \t\t\t\t}\r\n *      \t\t\t},\r\n *      \t\t}\r\n *      \t}\r\n *      },\r\n *      relationships: {\r\n *      \tINTERACTS: {\r\n *      \t\tvalue: 'weight',\r\n *      \t\t[Neovis.NEOVIS_ADVANCED_CONFIG]: {\r\n *      \t\t\tfunction: {\r\n *      \t\t\t\ttitle: (edge) => {\r\n *      \t\t\t\t\treturn viz.nodeToHtml(edge, undefined);\r\n *      \t\t\t\t}\r\n *      \t\t\t},\r\n *      \t\t}\r\n *      \t}\r\n *      },\r\n *      initial_cypher: 'MATCH (n)-[r]->(m) RETURN n,r,m'\r\n * }\r\n * ```\r\n */\r\nexport interface NeovisConfig extends BaseNeovisConfig {\r\n\tnonFlat?: false;\r\n\t/**\r\n\t * @example ```javascript\r\n\t *{\r\n\t * \tCharacter: {\r\n\t * \tlabel: 'pagerank',\r\n\t * \t\tgroup: 'community',\r\n\t * \t\t[Neovis.NEOVIS_ADVANCED_CONFIG]: {\r\n\t * \t\t\tcypher: {\r\n\t * \t\t\t\tvalue: \"MATCH (n) WHERE id(n) = $id RETURN n.size\"\r\n\t * \t\t\t},\r\n\t * \t\t\tfunction: {\r\n\t * \t\t\t\ttitle: (node) => {\r\n\t * \t\t\t\t\treturn viz.nodeToHtml(node, undefined);\r\n\t * \t\t\t\t}\r\n\t * \t\t\t},\r\n\t * \t\t}\r\n\t * \t}\r\n\t * }\r\n\t * ```\r\n\t */\r\n\tlabels?: {\r\n\t\t[label: string]: LabelConfig,\r\n\t\t[NEOVIS_DEFAULT_CONFIG]?: LabelConfig\r\n\t};\r\n\t/**\r\n\t * @example\r\n\t * ``` js\r\n\t * {\r\n\t *      INTERACTS: {\r\n\t *  \t    value: 'weight',\r\n\t *  \t    [Neovis.NEOVIS_ADVANCED_CONFIG]: {\r\n\t *  \t    \tfunction: {\r\n\t *  \t    \t\ttitle: (edge) => {\r\n\t *  \t    \t\t\treturn viz.nodeToHtml(edge, undefined);\r\n\t *  \t    \t\t}\r\n\t *  \t    \t},\r\n\t *  \t    }\r\n\t *      }\r\n\t * }\r\n\t * ```\r\n\t */\r\n\trelationships?: {\r\n\t\t[relationship: string]: RelationshipConfig,\r\n\t\t[NEOVIS_DEFAULT_CONFIG]?: RelationshipConfig\r\n\t};\r\n}\r\n\r\n/**\r\n * non flat version of the configuration (without Symbols)\r\n * look at the normal config for more information\r\n *\r\n * @example\r\n * ```js\r\n * {\r\n *      container_id: 'viz',\r\n *      nonFlat: true,\r\n *      neo4j: {\r\n *      \tserver_url: 'bolt://localhost:7687',\r\n *      \tserver_user: 'neo4j',\r\n *      \tserver_password: 'gland-presentation-worry'\r\n *      },\r\n *      visConfig: {\r\n *      \tnodes: {\r\n *      \t\tshape: 'square'\r\n *      \t},\r\n *      \tedges: {\r\n *      \t\tarrows: {\r\n *      \t\t\tto: {enabled: true}\r\n *      \t\t}\r\n *      \t},\r\n *      },\r\n *      labels: {\r\n *      \tCharacter: {\r\n *      \t\tproperty: {\r\n *      \t\t    label: 'pagerank',\r\n *      \t\t    group: 'community'\r\n *      \t    }\r\n *      \t\tcypher: {\r\n *      \t\t\tvalue: \"MATCH (n) WHERE id(n) = $id RETURN n.size\"\r\n *      \t\t},\r\n *      \t\tfunction: {\r\n *      \t\t\ttitle: (node) => {\r\n *      \t\t\t\treturn viz.nodeToHtml(node, undefined);\r\n *      \t\t\t}\r\n *      \t\t}\r\n *      \t}\r\n *      },\r\n *      relationships: {\r\n *      \tINTERACTS: {\r\n *              property: {\r\n *      \t\t    value: 'weight'\r\n *      \t    }\r\n *      \t\tfunction: {\r\n *      \t\t\ttitle: (edge) => {\r\n *      \t\t\t\treturn viz.nodeToHtml(edge, undefined);\r\n *      \t\t\t}\r\n *      \t\t}\r\n *      \t}\r\n *      },\r\n *      initial_cypher: 'MATCH (n)-[r]->(m) RETURN n,r,m'\r\n * }\r\n * ```\r\n */\r\nexport interface NonFlatNeovisConfig extends BaseNeovisConfig {\r\n\tnonFlat: true;\r\n\tdefaultLabelConfig?: NonFlatNeoVisAdvanceConfig<VisNetwork.Node, Neo4jTypes.Node<number>>;\r\n\tdefaultRelationshipsConfig?: NonFlatNeoVisAdvanceConfig<VisNetwork.Edge, Neo4jTypes.Relationship<number>>;\r\n\tlabels?: Record<string, NonFlatNeoVisAdvanceConfig<VisNetwork.Node, Neo4jTypes.Node<number>>>\r\n\trelationships?: Record<string, NonFlatNeoVisAdvanceConfig<VisNetwork.Edge, Neo4jTypes.Relationship<number>>>;\r\n}\r\n\r\n/**\r\n * A network node with raw neo4j node\r\n */\r\nexport interface Node extends VisNetwork.Node {\r\n\t/**\r\n\t * @link https://neo4j.com/docs/api/javascript-driver/current/class/src/graph-types.js~Node.html\r\n\t */\r\n\tid: number;\r\n\traw: Neo4jTypes.Node<NumberOrInteger>;\r\n}\r\n\r\n/**\r\n * A network edge with raw neo4j relationship\r\n */\r\nexport interface Edge extends VisNetwork.Edge {\r\n\t/**\r\n\t * https://neo4j.com/docs/api/javascript-driver/current/class/src/graph-types.js~Relationship.html\r\n\t */\r\n\tid: number;\r\n\traw: Neo4jTypes.Relationship<NumberOrInteger>;\r\n}\r\n\r\nfunction isNeo4jDriver(neo4jConfig: Neo4jTypes.Driver | Neo4jConfig): neo4jConfig is Neo4jTypes.Driver {\r\n\treturn neo4jConfig instanceof Neo4j.driver;\r\n}\r\n\r\n\r\nexport class NeoVis {\r\n\t_data = {\r\n\t\tnodes: new vis.DataSet<Node>(),\r\n\t\tedges: new vis.DataSet<Edge>()\r\n\t};\r\n\t#network: VisNetwork.Network = null;\r\n\t#events = new EventController();\r\n\tprivate _config: NeovisConfig | NonFlatNeovisConfig;\r\n\tprivate _driver: Neo4jTypes.Driver;\r\n\tprivate _database: string;\r\n\tprivate _query: Cypher;\r\n\tprivate _container: HTMLElement;\r\n\r\n\t/**\r\n\t * Get current vis nodes from the graph\r\n\t */\r\n\tget nodes(): VisNetwork.DataSet<Node> {\r\n\t\treturn this._data.nodes;\r\n\t}\r\n\r\n\t/**\r\n\t * Get current vis edges from the graph\r\n\t */\r\n\tget edges(): VisNetwork.DataSet<Edge> {\r\n\t\treturn this._data.edges;\r\n\t}\r\n\r\n\t/**\r\n\t * Get current network\r\n\t */\r\n\tget network(): VisNetwork.Network | undefined{\r\n\t\treturn this.#network;\r\n\t}\r\n\r\n\t/**\r\n\t *\r\n\t * @constructor\r\n\t * @param {object} config - configures the visualization and Neo4j server connection\r\n\t */\r\n\tconstructor(config: NeovisConfig | NonFlatNeovisConfig) {\r\n\t\tthis._init(config);\r\n\r\n\t\tthis._consoleLog(config);\r\n\t\tthis._consoleLog(defaults);\r\n\t}\r\n\r\n\t_consoleLog(message: any, level: string = 'log'): void {\r\n\t\tif (level !== 'log' || this._config.console_debug) {\r\n\t\t\t// eslint-disable-next-line no-console\r\n\t\t\tconsole[level](message);\r\n\t\t}\r\n\t}\r\n\r\n\t_init(config: NeovisConfig | NonFlatNeovisConfig) {\r\n\t\tlet defaultLabelConfig: NonFlatNeoVisAdvanceConfig<VisNetwork.Node, Neo4jTypes .Node<number>> | LabelConfig\r\n\t\tif(config.nonFlat && config.defaultLabelConfig) {\r\n\t\t\tdefaultLabelConfig = config.defaultLabelConfig;\r\n\t\t} else {\r\n\t\t\tdefaultLabelConfig = (config as NeovisConfig).labels?.[NEOVIS_DEFAULT_CONFIG];\r\n\t\t}\r\n\t\tif (defaultLabelConfig) {\r\n\t\t\tfor (let key of Object.keys(config.labels)) {\r\n\t\t\t\t// getting out of my for not changing the original config object\r\n\t\t\t\tconfig = {\r\n\t\t\t\t\t...config,\r\n\t\t\t\t\tlabels: {\r\n\t\t\t\t\t\t...config.labels,\r\n\t\t\t\t\t\t[key]: deepmerge(defaultLabelConfig, config.labels?.[key]) as any\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t}\r\n\t\tlet defaultRelationshipConfig: NonFlatNeoVisAdvanceConfig<VisNetwork.Edge, Neo4jTypes.Relationship<number>> | RelationshipConfig\r\n\t\tif(config.nonFlat && config.defaultLabelConfig) {\r\n\t\t\tdefaultRelationshipConfig = config.defaultRelationshipsConfig;\r\n\t\t} else {\r\n\t\t\tdefaultRelationshipConfig = (config as NeovisConfig).relationships?.[NEOVIS_DEFAULT_CONFIG];\r\n\t\t}\r\n\t\tif (defaultRelationshipConfig) {\r\n\t\t\t// getting out of my for not changing the original config object\r\n\t\t\tfor (let key of Object.keys(config.relationships)) {\r\n\t\t\t\tconfig = {\r\n\t\t\t\t\t...config,\r\n\t\t\t\t\trelationships: {\r\n\t\t\t\t\t\t...config.relationships,\r\n\t\t\t\t\t\t[key]: deepmerge(defaultRelationshipConfig, config.relationships[key])\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis._config = config;\r\n\t\tthis._driver = isNeo4jDriver(config.neo4j) ? config.neo4j : Neo4j.driver(\r\n\t\t\tconfig.neo4j?.server_url ?? defaults.neo4j.neo4jUri,\r\n\t\t\tNeo4j.auth.basic(\r\n\t\t\t\tconfig.neo4j?.server_user ?? defaults.neo4j.neo4jUser,\r\n\t\t\t\tconfig.neo4j?.server_password ?? defaults.neo4j.neo4jPassword\r\n\t\t\t),\r\n\t\t\tdeepmerge(defaults.neo4j.driverConfig, config.neo4j?.driverConfig ?? {})\r\n\t\t);\r\n\t\tthis._database = config.server_database;\r\n\t\tthis._query = config.initial_cypher ?? defaults.neo4j.initialQuery;\r\n\t\tthis._container = document.getElementById(config.container_id);\r\n\t}\r\n\r\n\tasync _runCypher(cypher: Cypher, id: number) {\r\n\t\tconst session = this._driver.session(this._database && { database: this._database });\r\n\t\tlet results: Neo4jTypes.Record[] = [];\r\n\r\n\t\ttry {\r\n\t\t\tconst result = await session.readTransaction(tx => tx.run(cypher, { id }));\r\n\t\t\tfor (let record of result.records) {\r\n\t\t\t\trecord.forEach((v) => {\r\n\t\t\t\t\tresults.push(v);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t} finally {\r\n\t\t\tawait session.close();\r\n\t\t}\r\n\r\n\t\tif (results.length === 0) {\r\n\t\t\treturn undefined;\r\n\t\t} else if (results.length === 1) {\r\n\t\t\treturn results.pop();\r\n\t\t}\r\n\r\n\t\treturn results;\r\n\t}\r\n\r\n\tasync _runFunction<NEO_TYPE>(func: Function, node: NEO_TYPE): Promise<any> {\r\n\t\tif (typeof func === 'function') {\r\n\t\t\treturn await func(node);\r\n\t\t}\r\n\t\tthrow new Error('Function type property field must be a function');\r\n\t}\r\n\r\n\t_buildStaticObject<VIS_TYPE>(staticConfig: VIS_TYPE, object: Node | Edge): void {\r\n\t\tif (staticConfig && typeof staticConfig === 'object') {\r\n\t\t\tfor (const prop of Object.keys(staticConfig)) {\r\n\t\t\t\tconst value = staticConfig[prop];\r\n\t\t\t\tif (value && typeof value === 'object') {\r\n\t\t\t\t\tif (!object[prop]) {\r\n\t\t\t\t\t\tobject[prop] = {};\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis._buildStaticObject(value, object[prop]);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tobject[prop] = value;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t_buildPropertyNameObject<VIS_TYPE, NEO_TYPE>(propertyNameConfig: RecursiveMapTo<VIS_TYPE, string>, object: Node | Edge, neo4jObj: NEO_TYPE): void {\r\n\t\tif (propertyNameConfig && typeof propertyNameConfig === 'object') {\r\n\t\t\tfor (const prop of Object.keys(propertyNameConfig)) {\r\n\t\t\t\tconst value = propertyNameConfig[prop];\r\n\t\t\t\tif (value && typeof value === 'object') {\r\n\t\t\t\t\tif (!object[prop]) {\r\n\t\t\t\t\t\tobject[prop] = {};\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis._buildStaticObject(value, object[prop]);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconst value = propertyNameConfig[prop];\r\n\t\t\t\t\tobject[prop] = _retrieveProperty(value, neo4jObj);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tasync _buildCypherObject<VIS_TYPE>(cypherConfig: RecursiveMapTo<VIS_TYPE, Cypher>, object: Node | Edge, id: number) {\r\n\t\tif (cypherConfig && typeof cypherConfig === 'object') {\r\n\t\t\tfor (const prop of Object.keys(cypherConfig)) {\r\n\t\t\t\tconst value = cypherConfig[prop];\r\n\t\t\t\tif (value && typeof value === 'object') {\r\n\t\t\t\t\tif (!object[prop]) {\r\n\t\t\t\t\t\tobject[prop] = {};\r\n\t\t\t\t\t}\r\n\t\t\t\t\tawait this._buildCypherObject(value, object[prop], id);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tobject[prop] = await this._runCypher(value, id);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tasync _buildFunctionObject<VIS_TYPE, NEO_TYPE>(functionConfig: RecursiveMapToFunction<VIS_TYPE, NEO_TYPE>, object: Node | Edge, neo4jObj: NEO_TYPE) {\r\n\t\tif (functionConfig && typeof functionConfig === 'object') {\r\n\t\t\tfor (const prop of Object.keys(functionConfig)) {\r\n\t\t\t\tconst func = functionConfig[prop];\r\n\t\t\t\tif (func && typeof func === 'object') {\r\n\t\t\t\t\tif (!object[prop]) {\r\n\t\t\t\t\t\tobject[prop] = {};\r\n\t\t\t\t\t}\r\n\t\t\t\t\tawait this._buildFunctionObject(func, object[prop], neo4jObj);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tobject[prop] = await this._runFunction(func, neo4jObj);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tasync #buildVisObject<VIS_TYPE, NEO_TYPE>(\r\n\t\tconfig: NeovisDataConfig<VIS_TYPE, NEO_TYPE> | NonFlatNeoVisAdvanceConfig<VIS_TYPE, NEO_TYPE>, baseObject: Node | Edge, neo4jObject\r\n\t) {\r\n\t\tif(!config) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tlet staticConfig: VIS_TYPE;\r\n\t\tlet cypherConfig: RecursiveMapTo<VIS_TYPE, Cypher>;\r\n\t\tlet propertyConfig: RecursiveMapTo<VIS_TYPE, string>;\r\n\t\tlet functionConfig: RecursiveMapToFunction<VIS_TYPE, NEO_TYPE>;\r\n\r\n\t\tif(this._config.nonFlat) {\r\n\t\t\tif (config[NEOVIS_ADVANCED_CONFIG] !== undefined) {\r\n\t\t\t\tthrow new Error('Advanced config and non flat config should not be together');\r\n\t\t\t}\r\n\t\t\tconfig = config as NonFlatNeoVisAdvanceConfig<VIS_TYPE, NEO_TYPE>;\r\n\t\t\tstaticConfig = config.static;\r\n\t\t\tcypherConfig = config.cypher;\r\n\t\t\tpropertyConfig = config.property;\r\n\t\t\tfunctionConfig = config.function;\r\n\t\t}  else {\r\n\t\t\tconfig = config as NeovisDataConfig<VIS_TYPE, NEO_TYPE>;\r\n\t\t\tconst advancedConfig = config[NEOVIS_ADVANCED_CONFIG];\r\n\t\t\tpropertyConfig = config;\r\n\t\t\tif (advancedConfig !== undefined && typeof advancedConfig != 'object') {\r\n\t\t\t\tthrow new Error('Advanced config should be an object. See documentation for details.');\r\n\t\t\t}\r\n\t\t\tcypherConfig = advancedConfig?.cypher;\r\n\t\t\tstaticConfig = advancedConfig?.static;\r\n\t\t\tfunctionConfig = advancedConfig?.function;\r\n\t\t}\r\n\t\tthis._buildPropertyNameObject(propertyConfig, baseObject, neo4jObject);\r\n\t\tthis._buildStaticObject(staticConfig, baseObject);\r\n\t\tawait this._buildCypherObject(cypherConfig, baseObject, baseObject.id);\r\n\t\tawait this._buildFunctionObject(functionConfig, baseObject, neo4jObject);\r\n\t}\r\n\r\n\t/**\r\n\t * Build node object for vis from a neo4j Node\r\n\t * FIXME: move to private api\r\n\t * @param neo4jNode\r\n\t * @returns {{}}\r\n\t */\r\n\tasync buildNodeVisObject(neo4jNode: Neo4jTypes.Node<NumberOrInteger>) {\r\n\t\tlet node: Partial<Node> = {};\r\n\t\tlet label: string = neo4jNode.labels[0];\r\n\r\n\t\tlet labelConfig: LabelConfig | NonFlatNeoVisAdvanceConfig<VisNetwork.Node, Neo4jTypes.Node<number>> = this._config?.labels?.[label] ?? this._config?.defaultLabelConfig ?? this._config?.labels?.[NEOVIS_DEFAULT_CONFIG];\r\n\r\n\t\tnode.id = Neo4j.isInt(neo4jNode.identity) ? (neo4jNode.identity as Neo4jTypes.Integer).toInt() : neo4jNode.identity as number;\r\n\t\tnode.raw = neo4jNode;\r\n\r\n\t\tawait this.#buildVisObject(labelConfig, node as Node, neo4jNode);\r\n\r\n\t\treturn node;\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * Build edge object for vis from a neo4j Relationship\r\n\t * @param r\r\n\t * @returns {{}}\r\n\t */\r\n\tasync buildEdgeVisObject(r: Neo4jTypes.Relationship<NumberOrInteger>) {\r\n\t\tconst relationshipConfig = this._config?.relationships?.[r.type] ?? this._config?.defaultRelationshipConfig ??\r\n\t\t\tthis._config?.relationships?.[NEOVIS_DEFAULT_CONFIG];\r\n\r\n\t\tlet edge: Partial<Edge> = {};\r\n\t\tedge.id = Neo4j.isInt(r.identity) ? (r.identity as Neo4jTypes.Integer).toInt() : r.identity as number;\r\n\t\tedge.from = Neo4j.isInt(r.start) ? (r.start as Neo4jTypes.Integer).toInt() : r.start as number;\r\n\t\tedge.to = Neo4j.isInt(r.end) ? (r.end as Neo4jTypes.Integer).toInt() : r.end as number;\r\n\t\tedge.raw = r;\r\n\r\n\t\tawait this.#buildVisObject(relationshipConfig, edge as Edge, r);\r\n\r\n\t\treturn edge;\r\n\t}\r\n\r\n\t// public API\r\n\r\n\trender(query?: Cypher) {\r\n\r\n\t\t// connect to Neo4j instance\r\n\t\t// run query\r\n\t\tlet recordCount = 0;\r\n\t\tconst _query = query || this._query;\r\n\t\tconst session = this._driver.session(this._database ? { database: this._database } : undefined);\r\n\t\tconst dataBuildPromises = [];\r\n\t\tsession\r\n\t\t\t.run(_query, { limit: 30 })\r\n\t\t\t.subscribe({\r\n\t\t\t\tonNext: (record: Neo4jTypes.Record) => {\r\n\t\t\t\t\trecordCount++;\r\n\r\n\t\t\t\t\tthis._consoleLog('CLASS NAME');\r\n\t\t\t\t\tthis._consoleLog(record?.constructor.name);\r\n\t\t\t\t\tthis._consoleLog(record);\r\n\r\n\t\t\t\t\tconst dataPromises = record.map(async (v) => {\r\n\t\t\t\t\t\tthis._consoleLog('Constructor:');\r\n\t\t\t\t\t\tthis._consoleLog(v?.constructor.name);\r\n\t\t\t\t\t\tif (v instanceof Neo4j.types.Node) {\r\n\t\t\t\t\t\t\tlet node = await this.buildNodeVisObject(v);\r\n\t\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t\tthis._data.nodes.update(node);\r\n\t\t\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\t\t\tthis._consoleLog(e, 'error');\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t} else if (v instanceof Neo4j.types.Relationship) {\r\n\t\t\t\t\t\t\tlet edge = await this.buildEdgeVisObject(v);\r\n\t\t\t\t\t\t\tthis._data.edges.update(edge);\r\n\r\n\t\t\t\t\t\t} else if (v instanceof Neo4j.types.Path) {\r\n\t\t\t\t\t\t\tthis._consoleLog('PATH');\r\n\t\t\t\t\t\t\tthis._consoleLog(v);\r\n\t\t\t\t\t\t\tlet startNode = await this.buildNodeVisObject(v.start);\r\n\t\t\t\t\t\t\tlet endNode = await this.buildNodeVisObject(v.end);\r\n\r\n\t\t\t\t\t\t\tthis._data.nodes.update(startNode);\r\n\t\t\t\t\t\t\tthis._data.nodes.update(endNode);\r\n\r\n\t\t\t\t\t\t\tfor (let obj of v.segments) {\r\n\t\t\t\t\t\t\t\tthis._data.nodes.update(await this.buildNodeVisObject(obj.start));\r\n\t\t\t\t\t\t\t\tthis._data.nodes.update(await this.buildNodeVisObject(obj.end));\r\n\t\t\t\t\t\t\t\tthis._data.edges.update(await this.buildEdgeVisObject(obj.relationship));\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t} else if (v instanceof Array) {\r\n\t\t\t\t\t\t\tfor (let obj of v) {\r\n\t\t\t\t\t\t\t\tthis._consoleLog('Array element constructor:');\r\n\t\t\t\t\t\t\t\tthis._consoleLog(obj?.constructor.name);\r\n\t\t\t\t\t\t\t\tif (obj instanceof Neo4j.types.Node) {\r\n\t\t\t\t\t\t\t\t\tlet node = await this.buildNodeVisObject(obj);\r\n\t\t\t\t\t\t\t\t\tthis._data.nodes.update(node);\r\n\r\n\t\t\t\t\t\t\t\t} else if (obj instanceof Neo4j.types.Relationship) {\r\n\t\t\t\t\t\t\t\t\tlet edge = await this.buildEdgeVisObject(obj);\r\n\r\n\t\t\t\t\t\t\t\t\tthis._data.edges.update(edge);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tdataBuildPromises.push(Promise.all(dataPromises));\r\n\t\t\t\t},\r\n\t\t\t\tonCompleted: async () => {\r\n\t\t\t\t\tawait Promise.all(dataBuildPromises);\r\n\t\t\t\t\tawait session.close();\r\n\r\n\t\t\t\t\tif (!this.#network) {\r\n\t\t\t\t\t\tlet options = deepmerge(defaults.visJs, this._config.visConfig ?? {});\r\n\r\n\t\t\t\t\t\tconst container = this._container;\r\n\r\n\t\t\t\t\t\tthis._consoleLog(this._data.nodes);\r\n\t\t\t\t\t\tthis._consoleLog(this._data.edges);\r\n\r\n\t\t\t\t\t\tthis.#network = new vis.Network(container, this._data, options);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis._consoleLog('completed');\r\n\t\t\t\t\tsetTimeout(\r\n\t\t\t\t\t\t() => {\r\n\t\t\t\t\t\t\tthis.#network.stopSimulation();\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t10000\r\n\t\t\t\t\t);\r\n\t\t\t\t\tthis.#events.generateEvent(NeoVisEvents.CompletionEvent, { record_count: recordCount });\r\n\r\n\t\t\t\t\tlet neoVis = this;\r\n\t\t\t\t\tthis.#network.on('click', function (params) {\r\n\t\t\t\t\t\tif (params.nodes.length > 0) {\r\n\t\t\t\t\t\t\tlet nodeId = this.getNodeAt(params.pointer.DOM);\r\n\t\t\t\t\t\t\tneoVis.#events.generateEvent(NeoVisEvents.ClickNodeEvent, {\r\n\t\t\t\t\t\t\t\tnodeId: nodeId,\r\n\t\t\t\t\t\t\t\tnode: neoVis._data.nodes.get(nodeId)\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t} else if (params.edges.length > 0) {\r\n\t\t\t\t\t\t\tlet edgeId = this.getEdgeAt(params.pointer.DOM);\r\n\t\t\t\t\t\t\tneoVis.#events.generateEvent(NeoVisEvents.ClickEdgeEvent, {\r\n\t\t\t\t\t\t\t\tedgeId: edgeId,\r\n\t\t\t\t\t\t\t\tedge: neoVis._data.edges.get(edgeId)\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tonError: (error) => {\r\n\t\t\t\t\tthis._consoleLog(error, 'error');\r\n\t\t\t\t\tthis.#events.generateEvent(NeoVisEvents.ErrorEvent, { error_msg: error });\r\n\t\t\t\t}\r\n\t\t\t} as object);\r\n\t}\r\n\r\n\t/**\r\n\t * Clear the data for the visualization\r\n\t */\r\n\tclearNetwork(): void {\r\n\t\tthis._data.nodes.clear();\r\n\t\tthis._data.edges.clear();\r\n\t}\r\n\r\n\r\n\t/**\r\n\t *\r\n\t * @param {string} eventType Event type to be handled\r\n\t * @param {handler} handler Handler to manage the event\r\n\t */\r\n\tregisterOnEvent(eventType: NeoVisEvents, handler: Function): void {\r\n\t\tthis.#events.register(eventType, handler);\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * Reset the config object and reload data\r\n\t * @param config\r\n\t */\r\n\treinit(config: NeovisConfig | NonFlatNeovisConfig): void {\r\n\t\tthis._init(config);\r\n\t\tthis.render();\r\n\t}\r\n\r\n\t/**\r\n\t * Clear the network and fetch live data form the server and reload the visualization\r\n\t */\r\n\treload(): void {\r\n\t\tthis.clearNetwork();\r\n\t\tthis.render();\r\n\t}\r\n\r\n\t/**\r\n\t * Stabilize the visualization\r\n\t */\r\n\tstabilize(): void {\r\n\t\tthis.#network.stopSimulation();\r\n\t\tthis._consoleLog('Calling stopSimulation');\r\n\t}\r\n\r\n\t/**\r\n\t * Execute an arbitrary Cypher query and re-render the visualization\r\n\t * @param query\r\n\t */\r\n\trenderWithCypher(query: Cypher): void {\r\n\t\t// this._config.initial_cypher = query;\r\n\t\tthis.clearNetwork();\r\n\t\tthis._query = query;\r\n\t\tthis.render();\r\n\t}\r\n\r\n\t/**\r\n\t * Execute an arbitrary Cypher query and update the current visualization, retaning current nodes\r\n\t * This function will not change the original query given by renderWithCypher or the inital cypher.\r\n\t * @param query\r\n\t */\r\n\tupdateWithCypher(query: Cypher): void {\r\n\t\tthis.render(query);\r\n\t}\r\n}\r\n\r\nfunction _propertyToHtml(key: string, value: any) {\r\n\tif (Array.isArray(value) && value.length > 1) {\r\n\t\tlet out = `<strong>${key}:</strong><br /><ul>`;\r\n\t\tfor (let val of value) {\r\n\t\t\tout += `<li>${val}</li>`;\r\n\t\t}\r\n\t\treturn out + '</ul>';\r\n\t}\r\n\treturn `<strong>${key}:</strong> ${value}<br>`;\r\n}\r\n\r\nfunction _retrieveProperty(prop: string, obj: any): any {\r\n\tif (typeof obj?.properties === 'object') {\r\n\t\treturn Neo4j.isInt(obj.properties[prop]) ? obj.properties[prop].toInt() : obj.properties[prop];\r\n\t}\r\n\tthrow new Error('Neo4j object is not properly constructed');\r\n}\r\n\r\nexport function objectToTitleHtml(neo4jObject: Neo4jTypes.Node<NumberOrInteger> |  Neo4jTypes.Relationship<NumberOrInteger>, titleProperties: string[]): HTMLDivElement {\r\n\tlet titleString = '';\r\n\tif (!titleProperties) {\r\n\t\ttitleProperties = Object.keys(neo4jObject.properties);\r\n\t}\r\n\tfor (const key of titleProperties) {\r\n\t\tconst propVal = _retrieveProperty(key, neo4jObject);\r\n\t\tif (propVal) {\r\n\t\t\ttitleString += _propertyToHtml(key, propVal);\r\n\t\t}\r\n\t}\r\n\tconst title = document.createElement('div');\r\n\ttitle.innerHTML = titleString;\r\n\treturn title;\r\n}\r\n\r\nexport function objectToTitleString(neo4jObject: Neo4jTypes.Node<NumberOrInteger> |  Neo4jTypes.Relationship<NumberOrInteger>, titleProperties: string[]): string {\r\n\tlet title = '';\r\n\tif (!titleProperties) {\r\n\t\ttitleProperties = Object.keys(neo4jObject.properties);\r\n\t}\r\n\tfor (const key of titleProperties) {\r\n\t\tconst propVal = _retrieveProperty(key, neo4jObject);\r\n\t\tif (propVal) {\r\n\t\t\ttitle += `${key}: ${propVal}\\n`;\r\n\t\t}\r\n\t}\r\n\treturn title;\r\n}\r\n\r\n/**\r\n * @deprecated for migration only\r\n */\r\nexport interface OldLabelConfig {\r\n\tcaption?: string;\r\n\tsize?: string;\r\n\tcommunity?: string;\r\n\tsizeCypher?: string;\r\n\timage?: string;\r\n\tfont?: any;\r\n\ttitle_properties: string[];\r\n}\r\n\r\n/**\r\n * @deprecated for migration only\r\n */\r\nexport interface OldRelationshipConfig {\r\n\tthickness?: string;\r\n\tcaption?: boolean | string;\r\n}\r\n\r\n/**\r\n * @deprecated for migration only\r\n */\r\nexport interface OldNeoVisConfig {\r\n\tcontainer_id: string;\r\n\tserver_url: string;\r\n\tserver_user: string;\r\n\tserver_password: string;\r\n\tserver_database: string;\r\n\tlabels?: {\r\n\t\t[label: string]: OldLabelConfig,\r\n\t\t[NEOVIS_DEFAULT_CONFIG]?: OldLabelConfig\r\n\t};\r\n\trelationships?: {\r\n\t\t[relationship: string]: OldRelationshipConfig,\r\n\t\t[NEOVIS_DEFAULT_CONFIG]?: OldRelationshipConfig\r\n\t};\r\n\tarrows?: boolean;\r\n\thierarchical?: boolean;\r\n\thierarchical_sort_method?: \"hubsize\" | \"directed\";\r\n\tinitial_cypher?: string;\r\n\tconsole_debug?: boolean;\r\n\tencrypted?: \"ENCRYPTION_OFF\" | \"ENCRYPTION_ON\";\r\n\ttrust?: \"TRUST_ALL_CERTIFICATES\" | \"TRUST_SYSTEM_CA_SIGNED_CERTIFICATES\";\r\n}\r\n\r\n/**\r\n * @deprecated will be removed in the future\r\n * migrate old config to the new one\r\n * @param oldNeoVisConfig 1.0.0 config object\r\n */\r\nexport function migrateFromOldConfig(oldNeoVisConfig: OldNeoVisConfig): NeovisConfig {\r\n\treturn {\r\n\t\tcontainer_id: oldNeoVisConfig.container_id,\r\n\t\tinitial_cypher: oldNeoVisConfig.initial_cypher,\r\n\t\tconsole_debug: oldNeoVisConfig.console_debug,\r\n\t\tserver_database: oldNeoVisConfig.server_database,\r\n\t\tneo4j: {\r\n\t\t\tserver_url: oldNeoVisConfig.server_url,\r\n\t\t\tserver_user: oldNeoVisConfig.server_url,\r\n\t\t\tserver_password: oldNeoVisConfig.server_password,\r\n\t\t\tdriverConfig: oldNeoVisConfig.encrypted || oldNeoVisConfig.trust ? {\r\n\t\t\t\tencrypted: oldNeoVisConfig.encrypted,\r\n\t\t\t\ttrust: oldNeoVisConfig.trust\r\n\t\t\t} : undefined\r\n\t\t},\r\n\t\tvisConfig: oldNeoVisConfig.arrows || oldNeoVisConfig.hierarchical ? {\r\n\t\t\tedges: oldNeoVisConfig.arrows ? {\r\n\t\t\t\tarrows: {\r\n\t\t\t\t\tto: {\r\n\t\t\t\t\t\tenabled: oldNeoVisConfig.arrows\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} : undefined,\r\n\t\t\tlayout: oldNeoVisConfig.hierarchical ? {\r\n\t\t\t\tenabled: oldNeoVisConfig.hierarchical,\r\n\t\t\t\tsortMethod: oldNeoVisConfig.hierarchical_sort_method\r\n\t\t\t} : undefined\r\n\t\t} : undefined,\r\n\t\tlabels: oldNeoVisConfig.labels ? (Object.entries(oldNeoVisConfig.labels) as [string | typeof NEOVIS_DEFAULT_CONFIG, OldLabelConfig][] )\r\n\t\t\t.concat(oldNeoVisConfig.labels?.[NEOVIS_DEFAULT_CONFIG] ? [[NEOVIS_DEFAULT_CONFIG, oldNeoVisConfig.labels[NEOVIS_DEFAULT_CONFIG]]] : [])\r\n\t\t\t.reduce((newLabelsConfig, [label, oldLabelConfig]) => {\r\n\t\t\t\tnewLabelsConfig[label] = {\r\n\t\t\t\t\tlabel: typeof oldLabelConfig.caption !== 'function' ? oldLabelConfig.caption : undefined,\r\n\t\t\t\t\tvalue: oldLabelConfig.size,\r\n\t\t\t\t\tgroup: oldLabelConfig.community,\r\n\t\t\t\t\t[NEOVIS_ADVANCED_CONFIG]: {\r\n\t\t\t\t\t\tcypher: oldLabelConfig.sizeCypher ? {\r\n\t\t\t\t\t\t\tvalue: oldLabelConfig.sizeCypher\r\n\t\t\t\t\t\t} : undefined,\r\n\t\t\t\t\t\tfunction: deepmerge({\r\n\t\t\t\t\t\t\ttitle: (props) => objectToTitleHtml(props, oldLabelConfig.title_properties)\r\n\t\t\t\t\t\t}, typeof oldLabelConfig.caption === 'function' ? { label: oldLabelConfig.caption } : {}) ,\r\n\t\t\t\t\t\tstatic: {\r\n\t\t\t\t\t\t\tfont: oldLabelConfig.font,\r\n\t\t\t\t\t\t\tshape: oldLabelConfig.image ? 'image' : 'dot',\r\n\t\t\t\t\t\t\timage: oldLabelConfig.image\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\treturn newLabelsConfig;\r\n\t\t\t}, {}) : undefined,\r\n\t\trelationships: oldNeoVisConfig.relationships ? Object.entries(oldNeoVisConfig.relationships)\r\n\t\t\t.concat(oldNeoVisConfig.relationships[NEOVIS_DEFAULT_CONFIG] ? [[NEOVIS_DEFAULT_CONFIG, oldNeoVisConfig.relationships[NEOVIS_DEFAULT_CONFIG]]] : [])\r\n\t\t\t.reduce((newLabelsConfig, [relationship, oldRelationshipsConfig]) => {\r\n\t\t\t\tnewLabelsConfig[relationship] = {\r\n\t\t\t\t\tvalue: oldRelationshipsConfig.thickness,\r\n\t\t\t\t\t[NEOVIS_ADVANCED_CONFIG]: {\r\n\t\t\t\t\t\tfunction: {\r\n\t\t\t\t\t\t\ttitle: oldRelationshipsConfig.caption ? objectToTitleHtml : undefined\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\treturn newLabelsConfig;\r\n\t\t\t}, {}) : undefined\r\n\t};\r\n}\r\n\r\nexport default NeoVis;"],"sourceRoot":""}